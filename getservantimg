#!/bin/bash
[[ -z "$1" ]] && echo "Usage: getservantimg <toram or store> <name> <name> et cetera" && echo "If not <toram> or <store>, saves to current directory." && exit 0
. $HOME/.local/bin/scripts4fgo/GLOBAL
. $HOME/.local/bin/scripts4fgo/GLOBAL_CHECK
case $1 in
	'-v')
		servants=${*:2};;
	'*')
		servants=$*
esac
for servantName in $servants; do
	{	
	if [[ "$( echo $servantName | grep '-' )" ]]; then
		id=$(getservantinfo id "$servantName") 
	else
		id=$(getservantinfo id "$servantName")
	fi
	images=$( jq --argjson ID "$id" -r -M '.[] | select(.id==$ID).extraAssets' "$RAM_SERVANTS_BASIC" | grep -o 'https.*' | sed -E 's/".?//g' )
	case $1 in
		'-v')
			echo "$images" | grep -o '[^/]*$' | sed "s|^|$outDir|g" &
			case $2 in
				'toram')
					outDir=$RAM_DIR/;;
				'store')
					outDir=$DATA_DIR/;;
				*)
					outDir=$PWD/;;
			esac;;
		'toram')
			outDir=$RAM_DIR/;;
		'store')
			outDir=$DATA_DIR/;;
		*)
			outDir=$PWD/;;
	esac
	[[ -d $outDir ]] && mkdir "$outDir"
	for image in $images; do
		wget -q -nc -P "$outDir" "$image" &
	done
	} &
done
